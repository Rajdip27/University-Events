@model UniversityEvents.Application.ViewModel.StudentRegistrationVm
@{
    ViewData["Title"] = "Register for Event";
}

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
<script src="https://unpkg.com/@@lottiefiles/lottie-player@latest/dist/lottie-player.js"></script>

<style>

    /* ======================================================
       🌟 AQUA NEO DESIGN SYSTEM (AQNDS)
       ====================================================== */
    :root {
        --aq-primary: #00b8d9;
        --aq-primary-dark: #0086a3;
        --aq-primary-light: #5ae6ff;
        --aq-bg-1: #ecfcff;
        --aq-bg-2: #f5ffff;
        --aq-glass-bg: rgba(255, 255, 255, 0.75);
        --aq-glass-border: rgba(0, 184, 217, 0.2);
        --aq-text-dark: #0f222b;
        --aq-text-light: #4e6b77;
        --aq-muted: #8aa6af;
        --aq-success: #06c27a;
        --aq-warning: #ffb84d;
        --aq-error: #ef4444;
        --aq-shadow-lg: 0px 25px 45px rgba(0, 184, 217, 0.18);
        --aq-shadow-md: 0 10px 25px rgba(0,0,0,0.08);
        --aq-trans: 0.35s cubic-bezier(.17,.67,.55,1.3);
    }

    /* ======================================================
       🌟 PAGE BACKGROUND
       ====================================================== */
    .aqn-body {
        background: linear-gradient(135deg, var(--aq-bg-1), var(--aq-bg-2), #ffffff);
        background-size: 300% 300%;
        animation: aqn-gradient 15s ease infinite;
        min-height: 100vh;
        padding: 40px 0;
        overflow-x: hidden;
    }

    @@keyframes aqn-gradient {
        0% {
            background-position: 0% 50%;
        }

        50% {
            background-position: 100% 50%;
        }

        100% {
            background-position: 0% 50%;
        }
    }

    /* ======================================================
       🌟 GLASS CARD CONTAINER
       ====================================================== */
    .aqn-glass-box {
        background: var(--aq-glass-bg);
        backdrop-filter: blur(18px) saturate(180%);
        border: 1px solid var(--aq-glass-border);
        border-radius: 28px;
        box-shadow: var(--aq-shadow-lg);
        overflow: hidden;
        animation: aqn-card-pop .8s both;
    }

    @@keyframes aqn-card-pop {
        0% {
            opacity: 0;
            transform: translateY(40px) scale(.95);
        }

        100% {
            opacity: 1;
            transform: translateY(0) scale(1);
        }
    }

    /* ======================================================
       🌟 HEADER
       ====================================================== */
    .aqn-header {
        background: linear-gradient(135deg, var(--aq-primary), var(--aq-primary-dark));
        padding: 60px 50px;
        color: #fff;
        position: relative;
    }

        .aqn-header::after {
            content: "";
            position: absolute;
            bottom: -35px;
            left: 0;
            width: 100%;
            height: 70px;
            background: rgba(255, 255, 255, 0.15);
            filter: blur(14px);
            border-radius: 50%;
        }

        .aqn-header h2 {
            font-size: 2.4rem;
            font-weight: 800;
            position: relative;
        }

            .aqn-header h2::after {
                content: "";
                width: 55px;
                height: 4px;
                background: var(--aq-primary-light);
                position: absolute;
                bottom: -12px;
                left: 0;
                border-radius: 4px;
            }

    /* ======================================================
       🌟 EVENT DETAILS CARD
       ====================================================== */
    .aqn-event-card {
        margin-top: 30px;
        margin-bottom: 40px;
        background: rgba(255, 255, 255, .6);
        border-radius: 22px;
        padding: 35px;
        border: 1px solid rgba(0, 184, 217, 0.2);
        backdrop-filter: blur(14px);
        box-shadow: 0 18px 50px rgba(0, 184, 217, .20);
        position: relative;
        overflow: hidden;
        animation: aqnEventIn .8s ease forwards;
    }

    @@keyframes aqnEventIn {
        from {
            opacity: 0;
            transform: translateY(30px);
        }

        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    .aqn-event-glow {
        position: absolute;
        top: -80px;
        right: -80px;
        width: 200px;
        height: 200px;
        background: var(--aq-primary-light);
        opacity: .25;
        filter: blur(90px);
        z-index: 0;
    }

    .aqn-event-header {
        display: flex;
        align-items: center;
        font-size: 1.4rem;
        font-weight: 700;
        color: var(--aq-primary-dark);
        margin-bottom: 25px;
        position: relative;
        z-index: 1;
    }

        .aqn-event-header i {
            font-size: 1.6rem;
            margin-right: 10px;
            color: var(--aq-primary);
        }

    .aqn-event-item {
        display: flex;
        align-items: center;
        padding: 12px 0;
        border-bottom: 1px dashed rgba(0, 184, 217, .25);
        transition: .3s ease;
    }

        .aqn-event-item:last-child {
            border-bottom: none;
        }

        .aqn-event-item i {
            font-size: 1.7rem;
            color: var(--aq-primary-dark);
            margin-right: 16px;
            width: 35px;
        }

        .aqn-event-item:hover {
            transform: translateX(6px);
        }

    .aqn-event-label {
        font-size: .9rem;
        font-weight: 600;
        color: var(--aq-muted);
        margin: 0;
    }

    .aqn-event-value {
        font-size: 1.15rem;
        font-weight: 700;
        margin: 0;
        color: var(--aq-text-dark);
    }

    /* ======================================================
       🌟 INPUT FIELDS
       ====================================================== */
    .aqn-field {
        position: relative;
        margin-bottom: 30px;
    }

        .aqn-field input {
            width: 100%;
            height: 60px;
            padding: 0 20px 0 58px;
            border-radius: 16px;
            font-size: 1rem;
            background: rgba(255,255,255,.85);
            border: 2px solid #d9e8ec;
            color: var(--aq-text-dark);
            transition: var(--aq-trans);
            box-shadow: var(--aq-shadow-md);
        }

            .aqn-field input:focus {
                border-color: var(--aq-primary);
                background: #fff;
                box-shadow: 0 0 0 4px rgba(0,184,217,.2);
                transform: translateY(-3px);
            }

    .aqn-icon {
        position: absolute;
        left: 20px;
        top: 50%;
        transform: translateY(-50%);
        font-size: 1.25rem;
        color: var(--aq-primary);
    }

    .aqn-label {
        position: absolute;
        pointer-events: none;
        left: 58px;
        top: 50%;
        transform: translateY(-50%);
        color: var(--aq-muted);
        transition: var(--aq-trans);
    }

    input:focus ~ .aqn-label,
    input.filled ~ .aqn-label {
        top: -7px;
        left: 18px;
        background: #fff;
        padding: 0 8px;
        font-size: 0.85rem;
        font-weight: 600;
        color: var(--aq-primary-dark);
    }

    /* ======================================================
       🌟 DRAG & DROP PHOTO UPLOAD
       ====================================================== */
    .aqn-upload-box {
        border: 3px dashed var(--aq-primary-light);
        border-radius: 25px;
        text-align: center;
        padding: 45px;
        background: linear-gradient(135deg, #f3feff, #effdff);
        transition: var(--aq-trans);
        cursor: pointer;
        position: relative;
    }

        .aqn-upload-box:hover {
            border-color: var(--aq-primary);
            transform: translateY(-5px);
            background: #fff;
        }

        .aqn-upload-box.dragover {
            background: rgba(0,184,217,.05);
            border-color: var(--aq-primary);
            transform: scale(1.02);
        }

    .aqn-preview {
        text-align: center;
    }

        .aqn-preview img {
            width: 200px;
            height: 200px;
            border-radius: 22px;
            object-fit: cover;
            box-shadow: var(--aq-shadow-md);
            animation: aqn-preview-pop .5s ease;
        }

    @@keyframes aqn-preview-pop {
        from {
            opacity: 0;
            transform: scale(.8);
        }

        to {
            opacity: 1;
            transform: scale(1);
        }
    }

    /* ======================================================
       🌟 BUTTONS
       ====================================================== */
    .aqn-btn {
        border-radius: 50px;
        padding: 13px 40px;
        font-size: 1rem;
        font-weight: 600;
        display: inline-flex;
        align-items: center;
        gap: 10px;
        border: none;
        cursor: pointer;
        transition: var(--aq-trans);
    }

    .aqn-btn-primary {
        background: linear-gradient(135deg, var(--aq-primary), var(--aq-primary-dark));
        color: #fff;
        box-shadow: 0 12px 25px rgba(0,184,217,.3);
    }

        .aqn-btn-primary:hover {
            transform: translateY(-4px);
            box-shadow: 0 18px 30px rgba(0,184,217,.4);
        }

    .aqn-btn-outline {
        background: transparent;
        border: 2px solid var(--aq-primary);
        color: var(--aq-primary);
    }

        .aqn-btn-outline:hover {
            background: var(--aq-primary);
            color: #fff;
        }

    /* ======================================================
       🌟 ERRORS
       ====================================================== */
    .aqn-error-msg {
        color: var(--aq-error);
        font-size: 0.9rem;
        margin-top: -18px;
        margin-bottom: 10px;
    }

    /* ======================================================
       🌟 RESPONSIVE
       ====================================================== */
    @@media (max-width:768px) {
        .aqn-header {
            padding: 40px 28px;
            text-align: center;
        }

            .aqn-header h2 {
                font-size: 2rem;
            }
    }

</style>

<!-- ============================
     BACKGROUND LOTTIE
=============================== -->
<lottie-player src="https://assets1.lottiefiles.com/packages/lf20_q5pk6p1k.json"
               class="position-fixed w-100 h-100"
               style="z-index:-1; opacity:.25;"
               background="transparent"
               speed="0.5"
               loop
               autoplay>
</lottie-player>

<div class="container aqn-body">
    <div class="row justify-content-center">
        <div class="col-lg-10 col-xl-8">

            <div class="aqn-glass-box">

                <!-- HEADER -->
                <div class="aqn-header d-flex flex-column justify-content-center align-items-center text-center">
                    <h2>Complete Your Registration</h2>
                   
                </div>

                <!-- EVENT DETAILS -->
                <div class="aqn-event-card">
                    <div class="aqn-event-glow"></div>
                    <div class="aqn-event-header"><i class="fas fa-star"></i>Event Details</div>

                    <div class="row">
                        <div class="col-6">
                            <div class="aqn-event-item">
                                <i class="fas fa-bullhorn"></i>
                                <div>
                                    <p class="aqn-event-label">Event Name</p>
                                    <p class="aqn-event-value">@Model.Event?.Name</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-6">
                            <div class="aqn-event-item">
                                <i class="fas fa-ticket-alt"></i>
                                <div>
                                    <p>Registration</p>
                                    <p>
                                        @if (Model.Event?.IsFree == true)
                                        {
                                            <span class="text-success fw-bold">Free</span>
                                        }
                                        else
                                        {
                                            <span class="text-primary fw-bold">@Model.Event?.RegistrationFee.ToString("C")</span>
                                        }
                                    </p>
                                </div>
                            </div>
                        </div>
                        <div class="col-6">
                            <div class="aqn-event-item">
                                <i class="fas fa-calendar-day"></i>
                                <div>
                                    <p class="aqn-event-label">Start Date</p>
                                    <p class="aqn-event-value">@Model.Event?.StartDate.ToUserTime().ToString("dd MMMM yyyy")</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-6">
                            <div class="aqn-event-item">
                        <i class="fas fa-calendar-check"></i>
                        <div>
                            <p class="aqn-event-label">End Date</p>
                            <p class="aqn-event-value">@Model.Event?.EndDate.ToUserTime().ToString("dd MMMM yyyy")</p>
                        </div>
                    </div>
                        </div>
                       
                        

                    </div>

                   
                   
                    

                   
                   
                </div>

                <!-- FORM BODY -->
                <div class="p-5">
                    <form asp-action="Register" asp-controller="StudentRegistration" enctype="multipart/form-data" method="post">
                        <input type="hidden" asp-for="EventId" />

                        <h4 class="fw-bold text-primary mb-4"><i class="fas fa-user-circle me-2"></i>Personal Information</h4>

                        <div class="row">
                            <div class="col-md-6">
                                <div class="aqn-field">
                                    <i class="fas fa-user aqn-icon"></i>
                                    <input asp-for="FullName" />
                                    <label class="aqn-label">Full Name</label>
                                </div>
                                <span asp-validation-for="FullName" class="aqn-error-msg"></span>
                            </div>
                            <div class="col-md-6">
                                <div class="aqn-field">
                                    <i class="fas fa-id-card aqn-icon"></i>
                                    <input asp-for="IdCardNumber" />
                                    <label class="aqn-label">Student ID</label>
                                </div>
                                <span asp-validation-for="IdCardNumber" class="aqn-error-msg"></span>
                            </div>
                            <div class="col-md-6">
                                <div class="aqn-field">
                                    <i class="fas fa-phone aqn-icon"></i>
                                    <input asp-for="PhoneNumber" />
                                    <label class="aqn-label">Phone Number</label>
                                </div>
                                <span asp-validation-for="PhoneNumber" class="aqn-error-msg"></span>
                            </div>
                            <div class="col-md-6">
                                <div class="aqn-field">
                                    <i class="fas fa-envelope aqn-icon"></i>
                                    <input asp-for="Email" type="email" />
                                    <label class="aqn-label">University Email</label>
                                </div>
                                <span asp-validation-for="Email" class="aqn-error-msg"></span>
                            </div>
                            <div class="col-12">
                                <div class="aqn-field">
                                    <i class="fas fa-graduation-cap aqn-icon"></i>
                                    <input asp-for="Department" />
                                    <label class="aqn-label">Department</label>
                                </div>
                                <span asp-validation-for="Department" class="aqn-error-msg"></span>
                            </div>
                        </div>

                        <!-- Photo Upload -->
                        <h4 class="fw-bold text-primary mt-5 mb-3"><i class="fas fa-camera me-2"></i>Upload Your Photo</h4>
                        <div id="aqnDrop" class="aqn-upload-box">
                            <input asp-for="ImageFile" type="file" accept="image/*" id="aqnFile" class="d-none" />
                            <i class="fas fa-cloud-upload-alt fa-3x text-primary mb-3"></i>
                            <p class="fw-bold">Click or Drag & Drop to Upload</p>
                            <p class="text-muted">PNG, JPG — Max 5MB</p>
                        </div>
                        <span asp-validation-for="ImageFile" class="aqn-error-msg"></span>
                        <div id="aqnPreview" class="aqn-preview mt-4 d-none">
                            <img id="aqnPreviewImg" />
                            <br>
                            <button type="button" onclick="aqnRemovePhoto()" class="aqn-btn aqn-btn-outline mt-3">
                                <i class="fas fa-trash"></i> Remove Photo
                            </button>
                        </div>

                        <!-- Terms -->
                        <div class="form-check mt-5 bg-light p-4 rounded-4">
                            <input type="checkbox" class="form-check-input" id="terms" required>
                            <label for="terms" class="form-check-label ms-2">
                                I agree to the <a href="#" class="text-primary">Terms</a> and
                                <a href="#" class="text-primary">Privacy Policy</a>
                            </label>
                        </div>

                        <!-- Buttons -->
                        <div class="d-flex justify-content-between mt-5">
                            <button type="button" onclick="history.back()" class="aqn-btn aqn-btn-outline">
                                <i class="fas fa-arrow-left"></i> Back
                            </button>
                            <button type="submit" class="aqn-btn aqn-btn-primary">
                                Submit Registration <i class="fas fa-check ms-1"></i>
                            </button>
                        </div>
                    </form>
                </div>

            </div>

            <p class="text-center text-muted mt-3">
                <i class="fas fa-shield-halved me-2"></i>Your data is encrypted & secure
            </p>

        </div>
    </div>
</div>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        // Floating label auto-fill
        document.querySelectorAll("input").forEach(inp => {
            if (inp.value.trim() !== "") inp.classList.add("filled");
            inp.addEventListener("input", () => {
                if (inp.value.trim() !== "") inp.classList.add("filled");
                else inp.classList.remove("filled");
            });
        });

        // Drag & Drop Upload
        const zone = document.getElementById("aqnDrop");
        const fileInput = document.getElementById("aqnFile");
        const preview = document.getElementById("aqnPreview");
        const previewImg = document.getElementById("aqnPreviewImg");

        zone.addEventListener("click", () => fileInput.click());

        zone.addEventListener("dragover", e => {
            e.preventDefault(); zone.classList.add("dragover");
        });

        zone.addEventListener("dragleave", () => zone.classList.remove("dragover"));

        zone.addEventListener("drop", e => {
            e.preventDefault(); zone.classList.remove("dragover");
            const files = e.dataTransfer.files;
            if (files.length) {
                fileInput.files = files;
                showPreview(files[0]);
            }
        });

        fileInput.addEventListener("change", e => {
            if (fileInput.files.length) showPreview(fileInput.files[0]);
        });

        function showPreview(file) {
            const reader = new FileReader();
            reader.onload = e => {
                previewImg.src = e.target.result;
                preview.classList.remove("d-none");
            };
            reader.readAsDataURL(file);
        }

        window.aqnRemovePhoto = () => {
            fileInput.value = "";
            preview.classList.add("d-none");
        };
    });
</script>
